---
// This component never needs to be explicitly imported - 
// it's automatically injected into Markdown code blocks via rehype plugin
const { code, lang = 'text' } = Astro.props;
---

<div class="code-block-wrapper">
  <div class="code-header">
    <button class="copy-button">
      Copy
    </button>
  </div>
  <pre><code class={`language-${lang}`}>{code}</code></pre>
</div>

<script is:inline>
  // Add functionality to copy buttons
  document.addEventListener('DOMContentLoaded', () => {
    const copyButtons = document.querySelectorAll('.copy-button');
    
    copyButtons.forEach(button => {
      button.addEventListener('click', () => {
        // Find the code element
        const codeBlock = button.closest('.code-block-wrapper')?.querySelector('code');
        if (!codeBlock) return;
        
        // Copy the text
        const text = codeBlock.textContent || '';
        navigator.clipboard.writeText(text).then(() => {
          // Show copied message
          const originalText = button.textContent;
          button.textContent = 'Copied!';
          button.classList.add('copied');
          
          // Reset after 2 seconds
          setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('copied');
          }, 2000);
        });
      });
    });
  });
</script> 